# 组件注册

Vue中组件注册有两种：全局注册 与 局部注册。

## 全局注册

要注册一个全局组件，可以使用 Vue.component(tagName, options)。例如：

```js
Vue.component('my-component', {
  // 选项
})
```

组件在注册之后，便可以作为自定义元素 `<my-component></my-component>` 在一个实例的模板中使用。注意确保在初始化根实例之前注册组件：

```js
<div id="example">
  <my-component></my-component>
</div>
```

示例

```html
<div id="app">
    <hello></hello>
</div>
Vue.component("hello",{
    template:"<div>\
        <h1>Vue</h1>\
        <p>Hello Vue!</p>\
    </div>"
})

new Vue({
    el:"#app"
})
```

使用Vue.component()注册的组件是 **全局** 的，这意味着该组件可以在任意Vue实例下使用。

```js
<div id="app1">
    <my-component></my-component>
</div>

<div id="app2">
    <my-component></my-component>
</div>

<!--该组件不会被渲染-->
<my-component></my-component>
// 全局组件
Vue.component('my-component', {
    template: '<div>This is a component!</div>'
})

var app1 = new Vue({
    el: '#app1'
});

var app2 = new Vue({
    el: '#app2'
})
```

## 局部注册

用选项对象的components属性实现局部注册。

```js
new Vue({
    el:"#app", // 局部注册，组件只在app实例下有效
    components:{
        "hello":{
            "template":"<h1>hello Vue!!!</h1>"
        }
    }
})
```

由于my-component组件是注册在#app1元素对应的Vue实例下的，所以它不能在其它Vue实例下使用。

示例：

```js
<div id="app">
    <hello></hello>
</div>
new Vue({
    el:"#app",
    components:{
        "hello":{
            "template":"<h1>hello Vue!!!</h1>"
        }
    }
})
```

## 注意

1. 组件有且只能有一个根元素，即 `template` 下面必须只有一个根元素
2. `template`中的 html 元素不能换行
3. 建议组件名称大写，为了同普通html元素作区分

## 组件名

定义组件名的方式有两种：

### 使用 kebab-case

```js
Vue.component('my-component-name', { /* ... */ })
```

当使用 kebab-case (短横线分隔命名) 定义一个组件时，你也必须在引用这个自定义元素时使用 kebab-case，例如 。

### 使用 PascalCase

```js
Vue.component('MyComponentName', { /* ... */ })
```

当使用 PascalCase (首字母大写命名) 定义一个组件时，你在引用这个自定义元素时两种命名法都可以使用。也就是说 `<my-component-name>` 和 `<MyComponentName>` 都是可接受的。注意，尽管如此，直接在 DOM (即非字符串的模板) 中使用时只有 kebab-case 是有效的。

## 模块系统中局部注册

如果你使用了诸如 Babel 和 webpack 的模块系统。在这些情况下，我们推荐创建一个 components 目录，并将每个组件放置在其各自的文件中。

然后你需要在局部注册之前导入每个你想使用的组件。例如，在一个假设的 ComponentB.js 或 ComponentB.vue 文件中：

```js
import ComponentA from './ComponentA'
import ComponentC from './ComponentC'

export default {
  components: {
    ComponentA,
    ComponentC
  },
  // ...
}
```

现在 ComponentA 和 ComponentC 都可以在 ComponentB 的模板中使用了。

## DOM 模板解析注意事项

当使用 DOM 作为模板时 (例如，使用 el 选项来把 Vue 实例挂载到一个已有内容的元素上)，你会受到 HTML 本身的一些限制，因为 Vue 只有在浏览器解析、规范化模板之后才能获取其内容。尤其要注意，像 `<ul>、<ol>、<table>、<select>` 这样的元素里允许包含的元素有限制，而另一些像 `<option>`这样的元素只能出现在某些特定元素的内部。

在自定义组件中使用这些受限制的元素时会导致一些问题，例如：

```html
<table>
  <my-row>...</my-row>
</table>
```

自定义组件 `<my-row>` 会被当作无效的内容，因此会导致错误的渲染结果。变通的方案是使用特殊的 is 特性：

```html
<table>
  <tr is="my-row"></tr>
</table>
```

应当注意，如果使用来自以下来源之一的字符串模板，则没有这些限制：

- `<script type="text/x-template">`
- JavaScript 内联模板字符串 template
- .vue 组件

因此，请尽可能使用字符串模板。

```js
<select id="app">
    <option is="opt"></option>
    <option is="opt"></option>
    <option is="opt"></option>
    <option is="opt"></option>
</select>

new Vue({
    el:"#app",
    components:{
        "opt":{
            "template":"<option>山西</option>"
        }
    }
})
```

## data 必须是函数

构造 Vue 实例时传入的各种选项大多数都可以在组件里使用。只有一个例外：data 必须是函数。

```js
Vue.component('my-component', {
  template: '<span>{{ message }}</span>',
  data: {
    message: 'hello'
  }
})
```

那么 Vue 会停止运行，并在控制台发出警告，告诉你在组件实例中 data 必须是一个函数。

```js
<div id="demo">
    <counter></counter>
    <counter></counter>
    <counter></counter>
</div>

var data = {num:0}
Vue.component('counter',{
    template:'<button @click="num++"> {{num}}</button>',
    data:function(){
        return data
    }
})

new Vue({
    el:"#demo"
})
```

由于这三个组件实例共享了同一个 data 对象，因此递增一个 counter 会影响所有组件！这就错了。我们可以通过为每个组件返回全新的数据对象来修复这个问题：

```js
Vue.component('counter',{
    template:'<button @click="num++"> {{num}}</button>',
    data:function(){
        return {
            num:0
        }
    }
})
```

## 使用 script 或 template 标签

在template选项中拼接HTML元素比较麻烦，无法使用换行，这也导致了HTML和JavaScript的高耦合性。
庆幸的是，Vue.js提供了两种方式将定义在JavaScript中的HTML模板分离出来。
这使得HTML代码和JavaScript代码是分离的，便于阅读和维护。

### 使用 script 标签

```js
<div id="app">
    <hello></hello>
</div>
<script type="text/x-template" id="hello">
    <div>
        <h1>data 必须是函数</h1>
        <p>构造 Vue 实例时传入的各种选项大多数都可以在组件里使用。只有一个例外：data 必须是函数。</p>
    </div>
</script>
<script>
Vue.component("hello",{
    template:"#hello"
})
new Vue({
    el:"#app"
})
</script>
```

template选项现在不再是HTML元素，而是一个id，Vue.js根据这个id查找对应的元素，然后将这个元素内的HTML作为模板进行编译。

> 使用 `<script>` 标签时，type属性指定为 `text/x-template` ，意在告诉浏览器这不是一段js脚本，浏览器在解析HTML文档时会忽略 `<script>` 标签内定义的内容。

### 使用 template 标签

如果使用 `<template>` 标签，则不需要指定type属性。

```js
<div id="app">
    <mycontent></mycontent>
</div>
<template id="mycontent">
    <div>
        <h1>data 必须是函数</h1>
        <p>构造 Vue 实例时传入的各种选项大多数都可以在组件里使用。只有一个例外：data 必须是函数。</p>
    </div>
</template>
<script>
    Vue.component('mycontent',{
        template:"#mycontent"
    })
    new Vue({
        el:'#app'
    })

</script>
```

**注意：** 然而IE(9-11)不支持`<template>`标签，这使得在IE中`<template>`标签中的内容会显示出来。解决办法——隐藏`<template>`标签:

```js
template{
    display: none;
}
```
