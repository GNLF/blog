# 过滤器

过滤器是一个通过输入数据，能够及时对数据进行处理并返回一个数据结果的简单函数。

> 注： 2.0版本后废除了1.0版本中的过滤器。现在只能使用自定义过滤器

## 过滤器定义与使用

### 使用

```js
{{插值 | filterName(str) }}
```

### 定义

```js
Vue.filters('filtersName',function(val,arg1,arg2,...){})
```

| 参数         | 描述                                                         |
| ------------ | ------------------------------------------------------------ |
| firltersName | 过滤器名字                                                   |
| function     | 过滤器函数，第一个参数必须是 默认的原始值(插值)，之后的参数为自定义参数。函数用来将接收到的参数格式化为想要的数据结果返回 |

## 过滤器定义方式

### 全局过滤器

```js
Vue.filter("uppercase",function(value){
    return value.toUpperCase();
})
new Vue({
    el:"#demo",
    data:{
        name:"king"
    }
})
<div id="demo">
    <p>{{name | uppercase }}</p>
</div>
```

### 局部过滤器

过滤器也可直接写在 vue实例 中

```html
<div id="demo">
    <p>{{ name | firstUpperCase }}</p>
</div>
<script>
new Vue({
    el:"#demo",
    data:{
        name:"king"
    },
    filters:{
        firstUpperCase:function(val){
            return val.substr(0,1).toUpperCase()+val.substr(1);
        }
    }
})
</script>
```

## 示例：日期过滤器

```js
Vue.filter("date",function(val,format='yyyy-MM-dd'){
    var date = new Date(val);
    if (/(y+)/.test(format)) {
        format = format.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length))
    }
    let o = {
        'M+': date.getMonth() + 1,
        'd+': date.getDate(),
        'h+': date.getHours(),
        'm+': date.getMinutes(),
        's+': date.getSeconds()
    };
    for(let k in o){
        if (new RegExp(`(${k})`).test(format)) {
            let str = o[k] + '';
            format = format.replace(RegExp.$1, (RegExp.$1.length === 1) ? str : ('00' + str).substr(str.length));
        }
    }
    return format;
})
<div id="demo">
    <p>{{time|date('yyyy-MM-dd hh:mm:ss')}}</p>
    <p>{{time|date('yy-MM-dd')}}</p>
    <p>{{time|date('yyyy-MM-dd')}}</p>
    <p>{{time|date('hh:mm:ss yyyy-MM-dd')}}</p>
    <p>{{time|date('hh:mm:ss')}}</p>
    <p>{{time|date('yyyy/MM/dd hh:mm:ss')}}</p>
</div>
new Vue({
    el:"#demo",
    data:{
        time:new Date()
    }
})
```

<iframe src="https://jsrun.pro/SSqKp/embedded/all/light/" id="JSREMB_18136" width="100%" height="306" frameborder="0" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin" style="box-sizing: border-box;"></iframe>

## 示例：货币格式化

```js
Vue.filter('currency', function(value = '0', currencyType = '￥',limit=2) {
    let res;
    value = value.toFixed(limit);
    let prev = value.toString().split('.')[0]; //获取整数部分
    let next = value.toString().split('.')[1];
    res = prev.toString().replace(/(\d)(?=(?:\d{3})+$)/g, '$1,') + '.' + next;
    return currencyType + res
})
<div id="app">
    <!-- 格式化货币 -->
    <p>{{price2|currency}}</p>

    <!-- 修改货币符号为$ -->
    <p>{{price|currency('$')}}</p>

    <!-- 保留3位小数 -->
    <p>{{price|currency('￥',3)}}</p>  
</div>
```

## 第三方过滤器库

| 项目                                              | 版本                                                         | 安装                            | 描述      | 重要性 |
| ------------------------------------------------- | ------------------------------------------------------------ | ------------------------------- | --------- | ------ |
| [vue-filter](https://github.com/wy-ei/vue-filter) | [![vue-status](https://img.shields.io/npm/v/vue-filter.svg)](https://npmjs.com/package/vue-filter) | `npm install vue-filter --save` | Vue过滤器 | ★★★★★  |
